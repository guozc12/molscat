      module pot_data_Tiemann
C
C     MODULE CONTAINING PARAMETERS OF A PAIR OF TIEMANN-STYLE
C     POTENTIAL CURVES OF AN ALKALI DIMER
C     UNITS USED ARE CM-1 AND POWERS OF ANGSTROM
C
C     POTENTIAL 1 IS SINGLET X, POTENTIAL 2 IS TRIPLET A
C
      USE physical_constants, ONLY: bohr_to_Angstrom
      SAVE
C
      CHARACTER(120) :: POTNAM =
     X ' NaRb with short range refitted by J. M. Hutson 2021 using'//
     X ' mid and long range from Wang et al., PRA 87, 050702 (2013)'
C
C     THIS POTENTIAL RETAINS THE MID-RANGE AND LONG-RANE COEFFICIENTS
C     IN THE SUPPLEMENTARY MATERIAL OF WANG ET AL. 
C     TWO SHORT-RANGE PARAMETERS (SINGLET RSR AND TRIPLET NSR) ARE
C     MANUALLY ADJUSTED TO FIT OBSERVED BINDING ENERGIES
C     (1) AT B = 346.646 G, 611 kHz BELOW THE (1,1)+(1,1) THRESHOLD
C     (2) AT B = 478.052 G, 400 kHz BELOW THE (1,1)+(1,1) THRESHOLD
C     NO ATTEMPT HAS BEEN MADE TO DO A GLOBAL FIT TO ALL THE OBSERVED
C     RESONANCES, WHICH WOULD BE LIKELY TO REQUIRE CHANGING
C     ADDITIONAL POTENTIAL PARAMETERS.
C
C     PRINT CONTROL (FOR POTENTIAL ROUTINE ONLY)
C     0 = SILENT, 1 = TITLE, 2 = INTERNALLY CALCULATED PARAMETERS
C
      INTEGER IPRINT/2/
C
C     NUMBER OF TERMS IN POWER SERIES FOR CENTRAL REGION
C     (NOTE: HIGHEST POWER + 1 BECAUSE ARRAYS START AT 0)
C
      INTEGER :: NA(2) = (/36,21/)
C
C     EXPANSION COEFFICIENTS:
C
      DOUBLE PRECISION :: A(0:35,2) = reshape((/
     X  -5030.50869783D0,
     X  -0.662030723944292271D-01,
     X   0.253807725995464061D+05,
     X   0.929104757521979809D+04,
     X  -0.211814748606123285D+05,
     X  -0.284181834656136671D+05,
     X   0.210407753693068798D+04,
     X  -0.851968733976350748D+06,
     X  -0.123216494098773529D+07,
     X   0.383640579108661637D+08,
     X   0.109125343263982777D+08,
     X  -0.109331126199059677D+10,
     X   0.540863749615297675D+09,
     X   0.203930014933835602D+11,
     X  -0.222458146577416687D+11,
     X  -0.258727375257563232D+12,
     X   0.419458345047378906D+12,
     X   0.226157469213112939D+13,
     X  -0.493156268638760059D+13,
     X  -0.133732693094783848D+14,
     X   0.391427433409150078D+14,
     X   0.491914424477468672D+14,
     X  -0.214673998282790187D+15,
     X  -0.736821254504513125D+14,
     X   0.806693583557253000D+15,
     X  -0.249784752437157937D+15,
     X  -0.198517974510287375D+16,
     X   0.172480088271182725D+16,
     X   0.281094984850021900D+16,
     X  -0.441448085841028300D+16,
     X  -0.122221795646213325D+16,
     X   0.552071157529799900D+16,
     X  -0.210051881065563800D+16,
     X  -0.244906408631624500D+16,
     X   0.238499017935224850D+16,
     X  -0.611040299017092875D+15,

     X  -203.35070852D0,
     X   0.122517410860683240D+01,
     X   0.968561681714175506D+03,
     X  -0.167358901820848331D+03,
     X  -0.115108986132623340D+04,
     X   0.538103153477437104D+03,
     X   0.576427139041465671D+04,
     X  -0.137759208524156093D+05,
     X  -0.484354206699185452D+05,
     X   0.876873287464803143D+05,
     X   0.242372373596938676D+06,
     X  -0.283727768851481727D+06,
     X  -0.762367745318190078D+06,
     X   0.433100100910781766D+06,
     X   0.150133971696866141D+07,
     X  -0.489081569236799405D+05,
     X  -0.164041059210233274D+07,
     X  -0.680259713656829204D+06,
     X   0.665168317123337765D+06,
     X   0.606016435356653412D+06,
     X   0.137434664322447614D+06,
     X    0.D0, 0.D0, 0.D0, 0.D0, 0.D0, 0.D0, 0.D0, 0.D0,
     X    0.D0, 0.D0, 0.D0, 0.D0, 0.D0, 0.D0, 0.D0 /), shape(A))
C
C     LOGICAL VARIABLES TO CONTROL CONTINUITY MATCHING:
C
      LOGICAL :: MATCHL = .TRUE., MATCHV = .TRUE., MATCHD = .TRUE.
C
C     IF (MATCHL), ADJUST A(0) TO MAKE POTENTIAL  CONTINUOUS AT RLR
C     IF (MATCHL), ADJUST ASR  TO MAKE POTENTIAL  CONTINUOUS AT RSR
C     IF (MATCHD), ADJUST BSR  TO MAKE DERIVATIVE CONTINUOUS AT RSR
C     IF .FALSE., USE THE CORRESPONDING INPUT VALUE UNCHANGED AND
C     PRINT THE RESULTING MISMATCH FOR INFORMATION.
C
C     RM AND B ARE USED IN DEFINITION THE OF XI.
C     RSR AND RLR ARE SHORT-RANGE AND LONG-RANGE MATCHING POINTS.
C     PARAMETERS OF SHORT-RANGE POTENTIAL ASR + BSR*R**NSR.
C
       DOUBLE PRECISION ::  DUM = 1.7D0,
     X  RM(2)  = (/3.64340736D0, 5.60071538D0/),
     X  B(2)   = (/ -0.21D0, -0.47D0/),
     X  RSR(2) = (/2.7256D0, 4.65D0/),
     X  RLR(2) = (/11.3D0, 11.3D0/),
     X  NSR(2) = (/4.06143861049682720D0, 11.492D0/),
     X  ASR(2) = (/0.0D+00,0.0D+00/),  ! NOT USED WHEN MATCHD = .TRUE.
     X  BSR(2) = (/0.0D+00,0.0D+00/)   ! NOT USED WHEN MATCHD = .TRUE.
C
C     DISPERSION COEFFICIENTS
C
       DOUBLE PRECISION ::
     X  C6  = 0.129463596372576691D+08,
     X  C8  = 0.358980000000000000D+09,
     X  C10 = 0.130601455102733498D+11
C
C     POTENTIALS OCCASIONALLY HAVE AN EXTRA TERM -CEX/R**NEX IN V_LR
C     SET NEX = 0 TO SWITCH THIS OFF
C
      INTEGER :: NEX = 0
      DOUBLE PRECISION :: CEX = 0.D0
C
C     PARAMETERS OF EXCHANGE POTENTIAL
C     NOTE THAT BETA AND GAMMA ARE CONVENTIONALLY LINKED.
C     THREE OPTIONS ARE IMPLEMENTED HERE:
C        GAMBET = 0: USE INPUT VALUES UNCHANGED
C        GAMBET = 1: CALCULATE GAMMA FROM BETA
C        GAMBET = 2: CALCULATE BETA FROM GAMMA
C     IF CHANGED, THE INPUT VALUE IS PRINTED FOR COMPARISON
C
       INTEGER :: GAMBET = 0
       DOUBLE PRECISION ::
     X  EXSIGN(2) = (/-1.D0, +1.D0/),
     X  AEX = 0.31859846D+05,
     X  GAMMA = 5.00810D0,
     X  BETA = 2.20850D0
C
C     DISTANCE UNITS TO BE USED BY MOLSCAT/BOUND:
C     1.D0 FOR ANGSTROM, 0.529... FOR BOHR, ETC.
C
      DOUBLE PRECISION :: RUNITM = bohr_to_Angstrom
      CHARACTER(8) :: LENUNT='BOHR'
C
C     COMMON BLOCK TO BE USED FOR ANY PARAMETERS TO BE CHANGED BY
C     OTHER ROUTINES, FOR EXAMPLE WHEN LEAST-SQUARES FITTING
C
      COMMON/POTEXT/NSR
C
      end module pot_data_Tiemann
